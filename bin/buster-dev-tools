#!/usr/bin/env node
var dt = require("../lib/buster-dev-tools");
var projects = require("../project-list");

var args = process.argv.slice(2);
if (args.indexOf("-h") > -1 || args.indexOf("--help") > -1) {
    console.log("buster-dev-tools");
    console.log();
    console.log("  install   Installs all the things.");
    console.log("   update   Updates all the things.");
    console.log("     deps   Reinstalls all non-buster deps.");
    console.log(" depgraph   Produces a graph of dependencies (requires dot from http://www.graphviz.org/Download..php ).");
    return;
}

if (args.indexOf("install") > -1) {
    dt.doOperations(projects, [dt.clone, dt.submodules, dt.installDeps]);
    return;
}

if (args.indexOf("update") > -1) {
    dt.doOperations(projects, [dt.pull, dt.submodules, dt.installDeps]);
    return;
}

if (args.indexOf("deps") > -1) {
    dt.doOperations(projects, [dt.installDeps]);
    return;
}

if (args.indexOf("depgraph") > -1) {
    dt.doOperations(projects, [dt.dependencyGraph.init, dt.dependencyGraph.build]);
    return;
}

process.stderr.write("Unrecognized option. See --help.");
process.exit(1);